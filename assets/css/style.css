/* =============================================================
  STYLE.CSS — Blocchi numerati
  [1] Variabili, reset, tipografia
  [2] Liquid background
  [3] Header
  [4] Dock (scrollabile)
  [5] Layout + componenti
  [6] Filtri
  [7] Opzioni (card risposta)
  [8] Liste lezioni
  [9] Simulazione (segbar, pill)
  [10] Animazioni
============================================================= */

/* [1] Variabili, reset, tipografia */
:root {
  --bg: #0b1220;
  --panel: rgba(255,255,255,0.06);
  --card: rgba(255,255,255,0.12);
  --text: #f5f5f7;
  --muted: #a1a1aa;
  --primary: #007aff;   /* blu tipico iOS */
  --accent: #5ac8fa;    /* azzurro acqua */
  --ok: #34c759;        /* verde iOS */
  --err: #ff3b30;       /* rosso iOS */
  --border: rgba(255,255,255,0.18);
  /* iOS visual tokens */
  --ios-surface: rgba(255,255,255,0.04);
  --ios-elev: rgba(9,20,40,0.08);
  --ios-radius-large: 20px;
  --ios-radius-medium: 14px;
  --ios-radius-pill: 999px;
  --ios-shadow: 0 10px 30px rgba(9,20,40,0.12);
}
/* Theme overrides */
html.theme-light {
  /* modern light palette */
  --bg: linear-gradient(180deg,#f7fbff 0%, #eef6ff 100%);
  --panel: rgba(10,25,40,0.02);
  --card: rgba(255,255,255,0.96);
  --text: #091223;
  --muted: #6b7785;
  --primary: #0a66ff;
  --accent: #00b4ff;
  --border: rgba(9,20,40,0.06);
  --ok: #00a86b;
  --err: #c62828;
  --glass: rgba(255,255,255,0.75);
}
/* dark theme uses defaults in :root */
* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
html, body {
  margin:0; padding:0;
  background:var(--bg);
  color:var(--text);
  font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", Roboto, Inter, sans-serif;
}
/* Respect iOS safe area and give comfortable spacing */
body{ padding-top: env(safe-area-inset-top, 12px); padding-left: env(safe-area-inset-left, 12px); padding-right: env(safe-area-inset-right, 12px); }
a { color:inherit; text-decoration:none; }
/* end [1] */

/* [2] Liquid background */
.liquid-bg{position:fixed;inset:0;z-index:-1;overflow:hidden;pointer-events:none}
.blobs{position:absolute;inset:0;filter:url(#goo); opacity:.9}
.blob{position:absolute;width:420px;height:420px;border-radius:50%;background:radial-gradient(closest-side, rgba(124,108,246,.35), rgba(36,214,239,.15) 60%, transparent 70%);animation:float 14s ease-in-out infinite}
.blob.b2{left:55%;top:-10%;animation-duration:18s}
.blob.b3{left:-10%;top:45%;animation-duration:20s}
@keyframes float{0%{transform:translate(0,0)}50%{transform:translate(20px, -10px)}100%{transform:translate(0,0)}}

/* Confirm modal */
.modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:60}
.modal .backdrop{position:absolute;inset:0;background:rgba(2,6,12,0.6);backdrop-filter:blur(4px)}
.modal .dialog{position:relative;z-index:2;min-width:280px;max-width:92vw;padding:18px;border-radius:14px;background:var(--card);border:1px solid var(--border);box-shadow:var(--ios-shadow);text-align:left}
.modal .dialog h3{margin:0 0 8px 0;font-size:1.1rem}
.modal .dialog p{margin:0 0 12px 0;color:var(--muted)}
.modal .dialog .actions{display:flex;justify-content:flex-end;gap:8px}
.modal .dialog .actions .btn{min-width:96px}
.modal[aria-hidden="true"]{display:none}

/* [3] Header */
.app-header{position:sticky;top:0;backdrop-filter:saturate(1.3) blur(8px);border-bottom:1px solid var(--border);z-index:10;background:linear-gradient(180deg, rgba(15,23,42,.75), rgba(15,23,42,.55))}
.brandbar{display:flex;align-items:center;gap:12px;padding:12px 16px}
.logo{font-size:22px}
.logo img{height:36px; display:block; border-radius:8px; object-fit:cover}
@media (max-width:420px){ .logo img{height:30px} }
.brand{display:flex;flex-direction:column;line-height:1}
.brand .muted{color:var(--muted);font-size:12px}

/* [4] Dock (scrollabile) */
.dock{position:fixed;left:0;right:0;bottom:12px;z-index:15;pointer-events:none}
.dock-wrap{position:relative;display:flex;justify-content:center}
.dock-inner{display:flex;gap:10px;align-items:center;background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));backdrop-filter:blur(10px) saturate(1.1);border:1px solid var(--border);border-radius:999px;padding:8px;box-shadow:var(--ios-shadow);pointer-events:auto;max-width:92vw;overflow-x:auto;white-space:nowrap;-webkit-overflow-scrolling:touch}
.theme-light .dock-inner{ background: rgba(255,255,255,0.85); color: var(--text); box-shadow: 0 10px 30px rgba(9,20,40,0.06); }
.dock-inner::-webkit-scrollbar{display:none}
.dock a{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:999px;border:1px solid transparent;color:var(--text);font-weight:700}
.dock a.active{border-color:var(--primary);box-shadow:0 0 0 2px rgba(124,108,246,.25) inset;background:rgba(12,20,38,.85)}
.dock .icon{font-size:16px}
@media (max-width:360px){ .dock a span.lbl{display:none}}

/* [5] Layout + componenti */
main {
  padding:18px;
  max-width:980px;
  margin:0 auto 92px auto;
}
.panel { display:none; }
.panel.active { display:block; }

/* Titoli delle sezioni */
.section-header {
  text-align: center;              /* centra tutto il blocco */
  margin: 20px 0 30px 0;           /* spaziatura sopra e sotto */
}
.section-header h1 {
  margin: 0;
  font-weight: 700;
  font-size: 2rem;                 /* più grande */
  letter-spacing: -0.02em;
}
.section-header .sub {
  display: block;
  margin-top: 6px;
  font-size: 0.95rem;
  color: var(--muted);
}
.sub { color:var(--muted); margin:.3rem 0 1rem 0; }

.card {
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  backdrop-filter: blur(12px) saturate(140%);
  border: 1px solid var(--border);
  border-radius: var(--ios-radius-large);
  padding: 18px;
  margin-bottom: 14px;
  box-shadow: var(--ios-shadow);
}

.btn {
  border:0;
  border-radius: var(--ios-radius-medium);
  padding: 12px 16px;
  font-weight:700;
  cursor:pointer;
  transition: transform .12s cubic-bezier(.25,.8,.25,1), box-shadow .18s ease, background .18s ease;
  background: transparent;
  color: var(--text);
  min-height:44px; /* comfortable iOS tappable size */
  display:inline-flex; align-items:center; justify-content:center; gap:8px;
}
.btn.primary {
  background: linear-gradient(180deg, var(--primary), color-mix(in srgb, var(--primary) 70%, black 10%));
  color: white;
  box-shadow: 0 8px 20px rgba(10,90,200,0.14);
  border-radius: var(--ios-radius-medium);
}
/* Danger / terminate button */
.btn.danger{ background: linear-gradient(180deg, var(--err), color-mix(in srgb, var(--err) 70%, black 10%)); color:white; box-shadow:0 8px 20px rgba(200,40,40,0.14); }
.btn.danger::after{ background: rgba(255,255,255,0.08); }
.btn:active {
  transform: scale(.97);
}

/* Hide header terminate button during practice because inline control is used */
#endPractice{ display:none; }
.btnrow {
  display:flex; gap:10px; margin-top:12px; flex-wrap:wrap;
}
.small { font-size:13px; color:var(--muted); }

.kpis { display:flex; gap:10px; flex-wrap:wrap; margin-top:8px; }
.kpi {
  padding:10px 12px;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border:1px solid var(--border);
  border-radius:12px;
  font-weight:600;
}

.grid { display:grid; grid-template-columns:1fr; gap:12px; }
@media (min-width:700px){ .grid{grid-template-columns:1fr 1fr} }
.divider { border:1px solid var(--border); opacity:.3; margin:10px 0; }
/* end [5] */

/* [6] Filtri */
.filters{display:flex;gap:12px;flex-wrap:wrap;margin-bottom:12px}
label{display:flex;flex-direction:column;gap:6px;font-size:14px}
/* Uniform inputs look (including search) to avoid white default */
input[type="number"], input[type="text"], input[type="email"], input[type="search"]{
  padding:12px; border-radius:10px; border:1px solid var(--border);
  background:rgba(255,255,255,0.03); color:var(--text);
}
input[type="search"]::-webkit-search-cancel-button{ -webkit-appearance:none; height:14px; width:14px; background:none; }
input[type="search"]::placeholder{ color: var(--muted); }
input[type="search"]:focus{ outline:none; box-shadow: 0 6px 18px rgba(9,20,40,0.12); }

/* Custom select */
.custom-select{ position:relative; padding:12px;border-radius:10px;border:1px solid var(--border);background:var(--card);color:var(--text);min-width:160px; cursor:pointer; }
.custom-select .selected{ display:flex; align-items:center; gap:8px; }
.custom-select .chev{ margin-left:auto; opacity:.7 }
.custom-select[aria-expanded="true"]{ box-shadow:0 8px 20px rgba(9,20,40,0.08); }
.custom-select .options{ display:none; position:absolute; left:0; right:0; top:calc(100% + 8px); background:var(--card); border:1px solid var(--border); border-radius:10px; max-height:220px; overflow:auto; z-index:40; padding:6px; }
.custom-select[aria-expanded="true"] .options{ display:block; }
.custom-select .opt-item{ padding:8px 10px; border-radius:8px; cursor:pointer; }
.custom-select .opt-item:hover{ background: linear-gradient(90deg, rgba(124,108,246,0.06), rgba(90,200,250,0.04)); }
.custom-select .opt-item.active{ background: linear-gradient(90deg, rgba(124,108,246,0.12), rgba(90,200,250,0.08)); font-weight:700; }

/* Styled native select for a modern look (used by default now) */
.styled-select{
  -webkit-appearance:none; -moz-appearance:none; appearance:none;
  padding:10px 40px 10px 12px; min-width:160px; border-radius:10px; border:1px solid var(--border);
  background:var(--card) url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='2'><path d='M6 9l6 6 6-6'/></svg>") no-repeat right 10px center/18px auto;
  color:var(--text); font-weight:600; cursor:pointer;
}
.theme-light .styled-select{ background:var(--card) url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23091223' stroke-width='2'><path d='M6 9l6 6 6-6'/></svg>") no-repeat right 10px center/18px auto; color:var(--text); }
.styled-select:focus{ outline: none; box-shadow: 0 6px 18px rgba(9,20,40,0.12); }
.styled-select[disabled]{ opacity:0.6; cursor:not-allowed; }

/* Settings specific tweaks */
.card.settings { padding: 14px; }
.card.settings label { font-weight:600; }

/* [7] Opzioni (card risposta) */
.question{margin:.2rem 0 .8rem 0;font-size:18px}
.options{display:flex;flex-direction:column;gap:10px}
.opt{padding:14px;border:1px solid var(--border);border-radius:12px;background:rgba(12,20,38,.82);transition:border .15s ease, transform .05s ease;cursor:pointer}
.opt:active{transform:scale(.995)}
.opt.selected{border-color:var(--primary);box-shadow:0 0 0 2px rgba(124,108,246,.3) inset}
.opt.correct{border-color:var(--ok);box-shadow:0 0 0 2px rgba(34,197,94,.25) inset}
.opt.wrong{border-color:var(--err);box-shadow:0 0 0 2px rgba(239,68,68,.25) inset}

/* [8] Liste lezioni */
.list{list-style:none;padding:0;margin:0}
.list li{border:1px solid var(--border);border-radius:14px;padding:14px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));transition:transform .15s ease, border .2s}
.list li:hover{transform:translateY(-6px);border-color:var(--accent); box-shadow:0 18px 40px rgba(9,20,40,0.06);}
.lesson-title{font-weight:700;margin:0 0 .5rem 0}
.lesson-body{color:#d5dde6;line-height:1.65}
.figure{background:rgba(255,255,255,.02);border:1px solid var(--border);border-radius:12px;padding:10px;margin:10px 0}

/* [9] Simulazione */
.segbar{display:grid;grid-template-columns:repeat(6,1fr);gap:6px;margin-top:8px}
.seg{position:relative;height:14px;border-radius:999px;background:rgba(148,163,184,.2);overflow:hidden;border:1px solid var(--border);cursor:pointer}
.seg .fill{position:absolute;inset:0;width:0%;background:linear-gradient(90deg,var(--primary),var(--accent));transition:width .3s ease}
.seg .label{position:absolute;inset:auto auto 100% 0;font-size:11px;color:var(--muted)}
.seg.active{box-shadow:0 0 0 2px rgba(124,108,246,.3) inset}
.seg{height:12px}
.subj-buttons{display:flex;gap:8px;flex-wrap:wrap;margin:10px 0}
.pill{padding:8px 12px;border:1px solid var(--border);border-radius:999px;background:rgba(11,19,37,.7)}
.pill.active{border-color:var(--primary);box-shadow:0 0 0 2px rgba(124,108,246,.25) inset}
.timer{font-weight:700}

/* [9.1] Practice Timer (circolare) — griglia simmetrica (timer | titolo | timer) */
.practice-head{
  --timer-size: 86px;                    /* dimensione anello desktop */
  position: sticky; top: 10px; z-index: 5;

  display: grid;
  grid-template-columns: var(--timer-size) 1fr var(--timer-size);
  align-items: center;

  padding: 14px 16px;
  border: 1px solid var(--border);
  border-radius: var(--ios-radius-large);
  /* Use theme-aware card background so timer remains visible in dark/light themes */
  background: var(--card);
  backdrop-filter: blur(8px) saturate(150%);
  box-shadow: var(--ios-shadow);
  margin-bottom: 14px;
  min-height: 96px;
}

/* Light-theme blob / accent overrides */
.theme-light .blob{ background: radial-gradient(closest-side, rgba(122,80,255,0.12), rgba(0,180,255,0.06) 60%, transparent 80%); }
.theme-light .blob.b2{ background: radial-gradient(closest-side, rgba(10,120,255,0.12), rgba(100,200,255,0.06) 60%, transparent 80%); }
.theme-light .blob.b3{ background: radial-gradient(closest-side, rgba(0,200,170,0.12), rgba(120,220,200,0.05) 60%, transparent 80%); }

/* Inputs/styles for light theme */
.theme-light select, .theme-light input{ background: rgba(255,255,255,0.9); color:var(--text); border:1px solid var(--border); }
.theme-light .card{ background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(250,250,250,0.95)); }

/* Adjust timer background stroke for light theme so it's visible on light cards */
.theme-light .timer-badge .ring .bg{ stroke: rgba(9,20,40,0.06); }

/* Button active states: avoid heavy white overlay in light theme that mutes the label */
.btn:active{ transform: scale(.97); /* slight press */ }
.btn{ transition: transform .12s cubic-bezier(.25,.8,.25,1), box-shadow .18s ease, background .18s ease, color .12s ease; }
.btn:active{ background: rgba(255,255,255,0.03); }
.theme-light .btn:active{ background: rgba(0,0,0,0.04); }

/* Make the primary overlay subtler and theme-aware */
.btn.primary::after { background: rgba(255,255,255,0.12); }
.theme-light .btn.primary::after { background: rgba(0,0,0,0.06); }

/* colonna 1: solo uno SPACER della stessa larghezza del timer */
.practice-head::before{
  content: "";
  display: block;
  grid-column: 1;
  width: var(--timer-size);
  height: 1px;
}

/* colonna 2: titolo perfettamente centrato */
.practice-head .head-info{
  grid-column: 2;
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
  gap: 6px; text-align: center;
}
.practice-head .pill{ font-weight: 700; }

/* colonna 3: timer a destra */
.timer-badge{
  grid-column: 3;
  justify-self: end;
  width: var(--timer-size); height: var(--timer-size); min-width: var(--timer-size);
  position: relative; display: flex; align-items: center; justify-content: center;
}
.timer-badge .ring{ position:absolute; inset:0; transform:rotate(-90deg); }
.timer-badge .ring .bg{ fill:none; stroke:rgba(255,255,255,.12); stroke-width:10; }
.timer-badge .ring .fg{
  fill:none; stroke:var(--primary); stroke-width:10; stroke-linecap:round;
  stroke-dasharray:276; stroke-dashoffset:0;
  transition: stroke-dashoffset .8s cubic-bezier(.25,.8,.25,1), stroke .3s ease;
}
.timer-badge .ring .fg{ filter: drop-shadow(0 6px 12px rgba(10,90,200,0.12)); }
.timer-badge.low .ring .fg{ stroke: var(--err); }
.timer-badge .time{ position:relative; font-weight:800; letter-spacing:-.02em; }

/* Mobile: timer sotto, tutto centrato */
@media (max-width: 680px){
  .practice-head{
    --timer-size: 74px;                  /* timer un po’ più piccolo */
    grid-template-columns: 1fr;
    justify-items: center;
    row-gap: 10px;
    min-height: auto;
  }
  .practice-head::before{ display:none; }
  .practice-head .head-info{ grid-column: 1; }
  .timer-badge{ grid-column: 1; justify-self: center; }
}

/* [10] Animazioni */
.fade-in {
  animation: fadeIn .45s cubic-bezier(.25,.8,.25,1) both;
}
@keyframes fadeIn {
  from { opacity:0; transform: translateY(8px) scale(.98); }
  to   { opacity:1; transform: none; }
}

.btn.primary {
  position:relative;
  overflow:hidden;
}
.btn.primary::after {
  content:"";
  position:absolute;
  inset:0;
  background:rgba(255,255,255,0.2);
  opacity:0;
  transform:scale(0.8);
  border-radius:inherit;
  transition:opacity .3s ease, transform .3s ease;
}
.btn.primary:active::after {
  opacity:1;
  transform:scale(1);
}
/* end [10] */

/* Report charts */
.report-charts{ display:flex; flex-direction:column; gap:8px; }
.subject-row{ display:flex; align-items:center; gap:12px; padding:8px; border-radius:10px; background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border:1px solid var(--border); }
.subject-label{ min-width:180px; font-weight:700; color:var(--muted); }
.subject-bar-wrap{ flex:1; background: rgba(255,255,255,0.03); border-radius:8px; height:14px; overflow:hidden; border:1px solid rgba(255,255,255,0.02); }
.subject-bar{ height:100%; background: linear-gradient(90deg, var(--primary), var(--accent)); transition: width .6s cubic-bezier(.25,.8,.25,1); }
.subject-numbers{ min-width:110px; text-align:right; font-weight:700; }


/* [11] Modal iOS picker */
.modal{
  position:fixed; inset:0; z-index:50; display:none;
  align-items:center; justify-content:center;
}
.modal.show{ display:flex; }
.modal .backdrop{
  position:absolute; inset:0; background:rgba(0,0,0,.45); backdrop-filter:blur(4px);
}
.modal .sheet{
  position:relative; width:min(680px, 92vw);
  background: var(--card); color: var(--text); border:1px solid var(--border); backdrop-filter: blur(20px) saturate(180%);
  border-radius:28px; padding:22px 20px;
  box-shadow:0 24px 64px rgba(9,20,40,0.14);
}
.modal .title{ font-size:22px; font-weight:800; margin:0 0 12px 0; text-align:center; }
.modal .row{ display:flex; align-items:center; gap:12px; padding:6px 0; }
.modal .step{
  width:44px; height:44px; border-radius:14px; border:none; cursor:pointer;
  background: var(--primary); color:#fff; font-size:22px; font-weight:800;
}
.modal input[type="range"]{
  flex:1; accent-color: var(--accent); height:4px;
}
.modal .actions{ display:flex; justify-content:flex-end; gap:10px; margin-top:16px; }
.modal .actions .btn{ background: rgba(255,255,255,0.08); color: var(--text); border:1px solid var(--border);}
.modal .actions .btn.primary{ background: var(--primary); color:#fff; }

/* end [11] */
/* Evidenzia risposta corretta in modalità 'Mostra soluzione' (non seleziona) */
.opt.correct-hint { outline: 2px dashed var(--accent); box-shadow: 0 0 0 3px rgba(90,200,250,.2) inset; }
.opt.correct-hint::after { content: "✓"; font-weight: 800; margin-left: 8px; }
